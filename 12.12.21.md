# Анализ тональности

### Журавский Максим, группа 620

### Постановка задачи

В работе исследуется задача анализа тональности текстов. Для решения данной задачи используются два набора данных, содержащих тексты твитов, касающиеся различных операторов связи: Билайн, МТС, Мегафон, Теле2, Ростелеком, Комстар, Skylink. 

Каждое наблюдение в наборе данных содержит:

- текст твита;
- название оператора, который упоминается в твите;
- оценку тональности твита по 5-балльной шкале.

При решении задачи рассматриваются только 3 уровня тональности: негативная (класс «-1»), нейтральная (класс «0»), положительная (класс «1»). Тренировочный набор данных содержит 5,000 наблюдений:

- 2258 для класса «0»;
- 1608 для класса «-1»;
- 932 для класса «1».

Тестовый набор содержит 3,845 наблюдений:

- 2595 для класса «0»;
- 879 для класса «-1»;
- 371 для класса «1».

Таким образом, поставленная задача рассматривается как задача многоклассовой классификации с количеством классов равным 3.



### Построение модели

В качестве текстовых признаков предлагается использовать модели, основанные на принципе «мешка слов»:
1. Векторы, указывающие на наличие слов из словаря в тексте;
2. Векторы, полученные методом tf-idf по схемам nnc.nnc (частоты слов), lnc.lnc (логарифмированные частоты слов), ntc.ntc, ltc.ltc.

При этом исследуется возможность лемматизации слов и исключения из словаря наиболее и наименее частых слов. Для лемматизации текстов используется метод [MyStem](https://yandex.ru/dev/mystem/). Оптимальные доли исключаемых слов и стратегия разбиения текстов на токены подбираются методом поиска по сетке. Для получение более достоверных оценок эффективности при определенных значениях параметра используется метод K-Fold с количеством разбиений, равным 3.

Для классификации текстов используется метод опорных векторов с RBF ядром. Оптимальное значение параметра $\gamma$ ядра и стратегия построения разделяющей плоскости также подбираются методом поиска по сетке.



### Результаты экспериметов

Согласно результатам тестования наиболее эффективным методом для решения поставленной задачи является метод, разделяющий тексты на токены с помощью метода MyStem, исключающий из словаря 5% самых частых слов, использующий tf-idf со схемой ltc.ltc для извлечения признаков и разделяющий классы плоскостями по стратегии «один против одного».

Для данной модели были получены следующие оценки эффективности:

- F1-мера: для класса «0» – 0.812,  для класса «1» – 0.328, для класса «-1» – 0.636, среднее значение (полученное макроусреднением) – 0.592;
- Точность (полученное микроусреднением): 0.724.

Отметим, что точность на тестовом наборе данных не сильно отличается от точности на тренировочном наборе данных, 0.759. Таким образом, для предложенной модели не наблюдается проблема переобучения.

Заметим, что предложенный метод имеет значительно более низкую эффективность при классификации положительно окрашенных текстов. Вероятно, это связано с малым объемом наблюдений для данного класса. Ниже представлена матрица ошибок для тестового работа данных:

<img src="classification/cache/confusion.png" alt="Матрица ошибок" style="zoom:75%;" />

### Вывод

В работе была построена модель классификации текстов по тональности. Для решения задачи предлагается метод, использующий алгоритм TF-IDF для извлечения признаков и метод опорных векторов для классификации текстов. Данный метод показал точность 0.724 на тестовом наборе данных, значение F1-меры, полученное макроусреднением, равно 0.592.


